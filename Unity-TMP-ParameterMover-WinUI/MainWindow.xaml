<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Unity_TMP_ParameterMover_WinUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Unity_TMP_ParameterMover_WinUI"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Unity-TMP-ParameterMover-WinUI">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 自定义标题栏拖拽区域 -->
        <Grid x:Name="AppTitleBar" Grid.Row="0" Height="68" Background="Transparent" Margin="16,16,160,0"/>

        <!-- 标题栏 -->
        <Grid Grid.Row="0" Padding="24,16" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8,8,0,0" Margin="0,0,0,0" IsHitTestVisible="False">
            <StackPanel>
                <TextBlock Text="Unity TMP Parameter Mover" FontSize="28" FontWeight="SemiBold"/>
                <TextBlock Text="Unity TextMeshPro 字体参数移动工具" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,4,0,0"/>
            </StackPanel>
        </Grid>

        <!-- 主内容区 -->
        <ScrollViewer Grid.Row="1" Padding="16" VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="16">

                <!-- 文件选择区域 -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 原始文件选择卡片 -->
                    <Border Grid.Column="0" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            CornerRadius="8" Padding="20" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                        <StackPanel Spacing="12">
                            <TextBlock Text="原始文件" FontSize="18" FontWeight="SemiBold"/>
                            <TextBlock Text="选择需要被更新的文件或文件夹"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       TextWrapping="Wrap" FontSize="12"/>

                            <Button x:Name="BtnSelectOriginFiles"
                                    Content="选择文件"
                                    Click="BtnSelectOriginFiles_Click"
                                    HorizontalAlignment="Stretch"
                                    Style="{StaticResource AccentButtonStyle}"/>

                            <Button x:Name="BtnSelectOriginFolder"
                                    Content="选择文件夹"
                                    Click="BtnSelectOriginFolder_Click"
                                    HorizontalAlignment="Stretch"/>

                            <TextBlock x:Name="TxtOriginCount"
                                       Text="已选择: 0 个文件"
                                       FontSize="12"
                                       Foreground="{ThemeResource TextFillColorTertiaryBrush}"/>
                        </StackPanel>
                    </Border>

                    <!-- 来源文件选择卡片 -->
                    <Border Grid.Column="2" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            CornerRadius="8" Padding="20" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                        <StackPanel Spacing="12">
                            <TextBlock Text="来源文件" FontSize="18" FontWeight="SemiBold"/>
                            <TextBlock Text="选择参数来源文件（提供新参数的文件）"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       TextWrapping="Wrap" FontSize="12"/>

                            <Button x:Name="BtnSelectSourceFile"
                                    Content="选择来源文件"
                                    Click="BtnSelectSourceFile_Click"
                                    HorizontalAlignment="Stretch"
                                    Style="{StaticResource AccentButtonStyle}"/>

                            <TextBlock x:Name="TxtSourceFile"
                                       Text="未选择"
                                       FontSize="12"
                                       Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                       TextTrimming="CharacterEllipsis"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- 文件列表卡片 -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="20" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                    <StackPanel Spacing="12">
                        <Grid>
                            <TextBlock Text="待处理文件列表" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            <Button x:Name="BtnClearList"
                                    Content="清空列表"
                                    Click="BtnClearList_Click"
                                    HorizontalAlignment="Right"/>
                        </Grid>

                        <ListView x:Name="FileListView"
                                  Height="200"
                                  SelectionMode="None"
                                  BorderBrush="{ThemeResource ControlStrokeColorDefaultBrush}"
                                  BorderThickness="1"
                                  CornerRadius="4">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <FontIcon Grid.Column="0" Glyph="&#xE8A5;" FontSize="16" Margin="0,0,12,0"/>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="{Binding FileName}" FontWeight="SemiBold"/>
                                            <TextBlock Text="{Binding FilePath}"
                                                       FontSize="11"
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       TextTrimming="CharacterEllipsis"/>
                                        </StackPanel>
                                        <Button Grid.Column="2"
                                                Content="&#xE711;"
                                                FontFamily="Segoe MDL2 Assets"
                                                Click="BtnRemoveFile_Click"
                                                Tag="{Binding FilePath}"
                                                Background="Transparent"
                                                BorderThickness="0"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- 操作按钮 -->
                <Button x:Name="BtnStartProcess"
                        Content="开始处理"
                        Click="BtnStartProcess_Click"
                        HorizontalAlignment="Stretch"
                        Style="{StaticResource AccentButtonStyle}"
                        FontSize="16"
                        Padding="0,12"/>

                <!-- 进度显示卡片 -->
                <Border x:Name="ProgressCard"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8"
                        Padding="20"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        Visibility="Collapsed">
                    <StackPanel Spacing="12">
                        <TextBlock Text="处理进度" FontSize="18" FontWeight="SemiBold"/>
                        <ProgressBar x:Name="ProcessProgressBar"
                                     Value="0"
                                     Maximum="100"
                                     Height="8"/>
                        <TextBlock x:Name="TxtProgressStatus"
                                   Text="准备处理..."
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Border>

                <!-- 日志输出卡片 -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="20" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                    <StackPanel Spacing="12">
                        <Grid>
                            <TextBlock Text="处理日志" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            <Button x:Name="BtnClearLog"
                                    Content="清空日志"
                                    Click="BtnClearLog_Click"
                                    HorizontalAlignment="Right"/>
                        </Grid>

                        <ScrollViewer Height="300"
                                      BorderBrush="{ThemeResource ControlStrokeColorDefaultBrush}"
                                      BorderThickness="1"
                                      CornerRadius="4"
                                      Background="{ThemeResource LayerFillColorDefaultBrush}">
                            <TextBlock x:Name="TxtLog"
                                       Padding="12"
                                       FontFamily="Consolas"
                                       FontSize="12"
                                       TextWrapping="Wrap"
                                       Text="等待操作..."/>
                        </ScrollViewer>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
